@setHook(HOOK_STARTUP)
def _onBoot():  
    global state
    global pause 

    state = -1
    pause = 0
    
    i2cInit(False)           # No pullups needed
    #
    setOscillator(0x70,True) # Start the oscillator
    setOscillator(0x72,True) # Start the oscillator
    #
    setBrightness(0x70,15)   # Full brightness
    setBrightness(0x72,15)   # Full brightness
    #
    clearDisplay(0x70)       # Nothing showing
    clearDisplay(0x72)       # Nothing showing
    #
    setBlink(0x70,0,True)    # Display on, not blinking
    setBlink(0x72,0,True)    # Display on, not blinking

def clearDisplay(num):
    num = num << 1; # R/-W bit = 0 (write)
    i2cWrite(chr(num)+'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
    
def alienA(num):
    num = num << 1; # R/-W bit = 0 (write)
    i2cWrite(chr(num)+'\x00\x18\x00\x3C\x00\x7E\x00\xDB\x24\xFF\x00\x24\x00\x5A\x5A\xA5\xA5',1,False)
        
def alienB(num):
    num = num << 1; # R/-W bit = 0 (write)
    i2cWrite(chr(num)+'\x00\x18\x00\x3C\x00\x7E\x00\xDB\x00\xFF\x00\x5A\x00\x81\x81\x42\x42',1,False)
        
def setOscillator(num,power):
    num = num << 1; # R/-W bit = 0 (write)
    if power:
        power = 0x21
    else:
        power = 0x20
    i2cWrite(chr(num)+chr(power),1,False)    
    
def setBrightness(num,b):
    num = num << 1; # R/-W bit = 0 (write)
    if b<0 or b>15:
        b = 0
    b = b | 0xE0
    i2cWrite(chr(num)+chr(b),1,False)
        
def setBlink(num,rate,power):
    num = num << 1; # R/-W bit = 0 (write)
    if rate<0 or rate>3:
        rate = 0
    rate = rate << 1
    if power:
        rate = rate | 1
    rate = rate | 0x80
    i2cWrite(chr(num)+chr(rate),1,False)
    
@setHook(HOOK_100MS)
def _doEvery100ms(tick):
    global state
    global pause

    pause = pause + 1
    if(pause<5):
        return

    pause = 0
    state = state + 1
    if(state==10):
        state = 0;
    
    if(state==0):
        i2cWrite('\xE4\x00\x36\x08\x3c\x00\x3c\x00\x3c\x00\x36\x08\x7d\x40\xb8\x80\x1e\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1e\x00\xb8\x80\x7d\x40',1,False)
        
    if(state==1):
        i2cWrite('\xE4\x00\xbc\x80\x3c\x00\xbc\x80\xb6\x88\x7d\x40\x18\x00\x70\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x00\x18\x00\x7d\x40\xb6\x88',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        
    if(state==2):
        i2cWrite('\xE4\x00\x3c\x00\x3c\x00\x36\x08\x7d\x40\xb8\x80\x1e\x00\x00\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x00\x00\x00\x00\x1e\x00\xb8\x80\x7d\x40\x36\x08\x3c\x00',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        
    if(state==3):
        i2cWrite('\xE4\x00\xbc\x80\xb6\x88\x7d\x40\x18\x00\x70\x00\x00\x00\x00\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x00\x00\x70\x00\x18\x00\x7d\x40\xb6\x88\xbc\x80\x3c\x00',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        
    if(state==4):
        i2cWrite('\xE4\x00\x36\x08\x7d\x40\xb8\x80\x1e\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x1e\x00\xb8\x80\x7d\x40\x36\x08\x3c\x00\x3c\x00\x3c\x00',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)    
        
    if(state==5):
        i2cWrite('\xE4\x00\x7d\x40\x18\x00\x70\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x70\x00\x18\x00\x7d\x40\xb6\x88\xbc\x80\x3c\x00\xbc\x80\xb6\x88',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        
    if(state==6):
        i2cWrite('\xE4\x00\x36\x08\x7d\x40\xb8\x80\x1e\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x1e\x00\xb8\x80\x7d\x40\x36\x08\x3c\x00\x3c\x00\x3c\x00',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)   
        
    if(state==7):
        i2cWrite('\xE4\x00\xbc\x80\xb6\x88\x7d\x40\x18\x00\x70\x00\x00\x00\x00\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x00\x00\x70\x00\x18\x00\x7d\x40\xb6\x88\xbc\x80\x3c\x00',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False) 
        
    if(state==8):
        i2cWrite('\xE4\x00\x3c\x00\x3c\x00\x36\x08\x7d\x40\xb8\x80\x1e\x00\x00\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x00\x00\x00\x00\x1e\x00\xb8\x80\x7d\x40\x36\x08\x3c\x00',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        
    if(state==9):
        i2cWrite('\xE4\x00\xbc\x80\x3c\x00\xbc\x80\xb6\x88\x7d\x40\x18\x00\x70\x00\x00\x00',1,False)
        i2cWrite('\xE0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x00\x18\x00\x7d\x40\xb6\x88',1,False)
        i2cWrite('\xE2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',1,False)
        